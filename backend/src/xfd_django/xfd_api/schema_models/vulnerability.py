"""Vulnerability schemas."""
# Third-Party Libraries
# from pydantic.types import UUID1, UUID
# Standard Python Libraries
from datetime import datetime
from typing import Any, Optional
from uuid import UUID

# Third-Party Libraries
from pydantic import BaseModel, Json


class Vulnerability(BaseModel):
    """Vulnerability schema."""

    id: UUID
    createdAt: datetime
    updatedAt: datetime
    lastSeen: Optional[datetime]
    title: Optional[str]
    cve: Optional[str]
    cwe: Optional[str]
    cpe: Optional[str]
    description: Optional[str]
    references: Optional[Any]
    cvss: Optional[float]
    severity: Optional[str]
    needsPopulation: bool
    state: Optional[str]
    substate: Optional[str]
    source: Optional[str]
    notes: Optional[str]
    actions: Optional[Any]
    structuredData: Optional[Any]
    isKev: bool
    domainId_id: UUID
    serviceId_id: UUID

    class Config:
        from_attributes = True


class VulnerabilityFilters(BaseModel):
    """VulnerabilityFilters schema."""

    id: Optional[str] = None
    title: Optional[str] = None
    domain: Optional[str] = None
    severity: Optional[str] = None
    cpe: Optional[str] = None
    state: Optional[str] = None
    substate: Optional[str] = None
    organization: Optional[str] = None
    tag: Optional[str] = None
    isKev: Optional[bool] = None

    class Config:
        from_attributes = True


class VulnerabilitySearch(BaseModel):
    """VulnerabilitySearch schema."""

    page: int = 1
    sort: Optional[str] = "ASC"
    order: Optional[str] = "id"
    filters: Optional[VulnerabilityFilters] = None
    pageSize: Optional[int] = 25
    groupBy: Optional[str] = None

    class Config:
        from_attributes = True
